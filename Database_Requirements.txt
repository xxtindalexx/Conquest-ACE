================================================================================
CONQUEST ACE SERVER - DATABASE REQUIREMENTS
================================================================================

This document lists all required database tables, columns, and stored procedures
that need to be created in your MySQL databases. You can pull these from ILT or
create them manually.

================================================================================
AUTHENTICATION DATABASE (ace_auth)
================================================================================

-------------------------------------------
TABLE: account_quest
-------------------------------------------
Purpose: Account-wide quest tracking for Quest Bonus System
Columns:
  - accountId (uint, PRIMARY KEY, part 1)
  - quest (string/varchar(255), PRIMARY KEY, part 2)
  - num_Times_Completed (uint, nullable)

Primary Key: (accountId, quest)

-------------------------------------------
TABLE: leaderboard
-------------------------------------------
Purpose: Virtual table for leaderboard stored procedure results
Note: This may not need to be a physical table - it's used as a result set.
Columns:
  - LeaderboardID (ulong/bigint unsigned, PRIMARY KEY, AUTO_INCREMENT)
  - Score (ulong/bigint unsigned, nullable)
  - Account (uint/int unsigned, nullable)
  - Character (string/varchar(255), nullable)

-------------------------------------------
STORED PROCEDURE: TopQuestBonus
-------------------------------------------
Purpose: Returns top players by quest completion count (account-wide)
Returns: Leaderboard result set (Score, Account, Character, LeaderboardID)
Query Logic:
  - Join ace_auth.account with ace_world.character
  - Sum quest count per account from biota_properties_int64 WHERE type = 9006
  - Order by quest count DESC
  - Limit to top 100 or desired amount
  - Return columns: quest_count as Score, accountId as Account, character_name as Character, auto_increment as LeaderboardID

-------------------------------------------
STORED PROCEDURE: TopLevel
-------------------------------------------
Purpose: Returns top players by character level
Returns: Leaderboard result set (Score, Account, Character, LeaderboardID)
Query Logic:
  - Join ace_auth.account with ace_world.character and ace_world.biota
  - Get character level from biota_properties_int WHERE type = 25 (PropertyInt.Level)
  - Order by level DESC, then by total XP DESC for tiebreaking
  - Limit to top 100 or desired amount
  - Return columns: level as Score, accountId as Account, character_name as Character, auto_increment as LeaderboardID

-------------------------------------------
STORED PROCEDURE: TopEnlightenment
-------------------------------------------
Purpose: Returns top players by enlightenment count
Returns: Leaderboard result set (Score, Account, Character, LeaderboardID)
Query Logic:
  - Join ace_auth.account with ace_world.character and ace_world.biota
  - Get enlightenment from biota_properties_int WHERE type = 390 (PropertyInt.Enlightenment)
  - Order by enlightenment DESC
  - Limit to top 100 or desired amount
  - Return columns: enlightenment as Score, accountId as Account, character_name as Character, auto_increment as LeaderboardID

-------------------------------------------
STORED PROCEDURE: TopBank
-------------------------------------------
Purpose: Returns top players by banked pyreals
Returns: Leaderboard result set (Score, Account, Character, LeaderboardID)
Query Logic:
  - Join ace_auth.account with ace_world.character and ace_world.biota
  - Get banked pyreals from biota_properties_int64 WHERE type = 9004 (PropertyInt64.BankedPyreals)
  - Order by banked pyreals DESC
  - Limit to top 100 or desired amount
  - Return columns: banked_pyreals as Score, accountId as Account, character_name as Character, auto_increment as LeaderboardID

-------------------------------------------
STORED PROCEDURE: TopLum
-------------------------------------------
Purpose: Returns top players by banked luminance
Returns: Leaderboard result set (Score, Account, Character, LeaderboardID)
Query Logic:
  - Join ace_auth.account with ace_world.character and ace_world.biota
  - Get banked luminance from biota_properties_int64 WHERE type = 9005 (PropertyInt64.BankedLuminance)
  - Order by banked luminance DESC
  - Limit to top 100 or desired amount
  - Return columns: banked_luminance as Score, accountId as Account, character_name as Character, auto_increment as LeaderboardID

================================================================================
WORLD/SHARD DATABASE (ace_world or ace_shard)
================================================================================

-------------------------------------------
TABLE: biota_properties_int
-------------------------------------------
Note: This table should already exist in base ACE.
Ensure it can store the following custom PropertyInt values:

Custom PropertyInt Enum Values Used:
  - 390 = Enlightenment (already verified in code)

No new columns needed - existing table structure handles this.

-------------------------------------------
TABLE: biota_properties_int64
-------------------------------------------
Note: This table should already exist in base ACE.
Ensure it can store the following custom PropertyInt64 values:

Custom PropertyInt64 Enum Values Used (from PropertyInt64.cs):
  - 9000 = AllegianceXPCached
  - 9001 = AllegianceXPGenerated
  - 9002 = AllegianceXPReceived
  - 9003 = VerifyXp
  - 9004 = BankedPyreals (Banking System)
  - 9005 = BankedLuminance (Banking System)
  - 9006 = QuestCount (Quest Bonus System)
  - 9007 = LumAugCreatureCount
  - 9008 = LumAugItemCount
  - 9009 = LumAugLifeCount
  - 9010 = LumAugVoidCount
  - 9011 = LumAugWarCount
  - 9012 = AllegianceLumCached
  - 9013 = AllegianceLumGenerated
  - 9014 = AllegianceLumReceived
  - 9015 = BankedLegendaryKeys (Banking System)
  - 9016 = LumAugDurationCount
  - 9017 = LumAugSpecializeCount
  - 9018 = LumAugSummonCount
  - 9022 = LumAugMeleeCount
  - 9023 = LumAugMissileCount
  - 9024 = LumAugMeleeDefenseCount
  - 9025 = LumAugMissileDefenseCount
  - 9026 = LumAugMagicDefenseCount
  - 9028 = ConquestCoins (Custom Currency)
  - 9029 = SoulFragments (PvP Currency)
  - 9030 = EventTokens (Event Currency)
  - 9031 = LastSoulFragmentLootTime (PK System cooldown tracking)

No new columns needed - existing table structure handles this.

-------------------------------------------
TABLE: biota_properties_position
-------------------------------------------
Note: This table should already exist in base ACE.
Ensure the following column exists for dungeon variations:

Modified/New Column:
  - VariationId (int, nullable) - Added for dungeon instancing/variations

If this column doesn't exist, add it:
  ALTER TABLE biota_properties_position ADD COLUMN VariationId INT NULL;

================================================================================
ADDITIONAL CONQUEST SYSTEMS
================================================================================

The following systems have PropertyInt64 entries defined but implementation
details were not provided in the conversation summary:

1. CONQUEST COINS (PropertyInt64.ConquestCoins = 9028)
   - Non-tradable currency for augmentations, imbues, tailors
   - Implementation: Unknown - may need creature loot tables or quest rewards

2. EVENT TOKENS (PropertyInt64.EventTokens = 9030)
   - Tradable event currency
   - Implementation: Unknown - may need event scripts or vendor systems

3. SOUL FRAGMENTS (PropertyInt64.SoulFragments = 9029)
   - Non-tradable PvP currency
   - Implementation: COMPLETE - drops 1-3 on PK deaths with 6-8 hour cooldown
   - Weenie ID: 999999998 (placeholder, needs actual weenie creation)

================================================================================
SUMMARY CHECKLIST
================================================================================

Auth Database (ace_auth):
  [ ] Create table: account_quest
  [ ] Create table: leaderboard (or use as virtual result set)
  [ ] Create stored procedure: TopQuestBonus
  [ ] Create stored procedure: TopLevel
  [ ] Create stored procedure: TopEnlightenment
  [ ] Create stored procedure: TopBank
  [ ] Create stored procedure: TopLum

World Database (ace_world/ace_shard):
  [ ] Verify biota_properties_int exists and can store PropertyInt 390
  [ ] Verify biota_properties_int64 exists and can store PropertyInt64 9000-9031
  [ ] Add VariationId column to biota_properties_position (if not exists)

Content Creation (Weenies/Items):
  [ ] Create Soul Fragment weenie (ID: 999999998)
  [ ] Create 20 Augmentation Gem weenies (IDs: 999000-999019)
  [ ] Implement Conquest Coin drop system
  [ ] Implement Event Token system

Configuration:
  [ ] Populate Landblock.pkDungeonLandblocks with PK-only dungeon landblock IDs

================================================================================
END OF DOCUMENT
================================================================================
